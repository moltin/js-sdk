/*! moltin (nodejs) minified - v1.0.0 - 2016-03-31 */
var Moltin,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(b in this&&this[b]===a)return b;return-1},__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};Moltin=function(){"use strict";function a(a){this.options=this.Merge(this.options,a),this.Storage=new z,this.Address=new c(this),this.Brand=new d(this),this.Cart=new f(this),this.Category=new g(this),this.Checkout=new h(this),this.Collection=new i(this),this.Currency=new j(this),this.Entry=new n(this),this.Gateway=new q(this),this.Language=new r(this),this.Order=new t(this),this.Product=new v(this),this.Shipping=new x(this),this.Tax=new A(this),this.Cache=new e(this),this.Customer=new k(this),this.CustomerGroup=new l(this),this.Email=new m(this),this.Field=new o(this),this.Flow=new p(this),this.Payment=new u(this),this.Promotion=new w(this),this.Stats=new y(this),this.Transaction=new B(this),this.Variation=new C(this),this.Webhook=new D(this),this.Storage.get("mcurrency")&&(this.options.currency=this.Storage.get("mcurrency")),this.Storage.get("mlanguage")&&(this.options.language=this.Storage.get("mlanguage"))}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D;return a.prototype.options={publicId:"",secretKey:"",auth:{},url:"api.molt.in",version:"v1",debug:!1,currency:!1,language:!1,methods:["GET","POST","PUT","DELETE"],notice:function(a,b){return console.log(a+": "+b)}},a.prototype.Merge=function(a,b){var c,d,e;d={};for(c in a)e=a[c],d[c]=e;for(c in b)e=b[c],d[c]=e;return d},a.prototype.InArray=function(a,b){return b&&!(__indexOf.call(b,a)<0)},a.prototype.Serialize=function(a,b){var c,d,e;null==b&&(b=null),d=[];for(c in a)e=a[c],c=null!==b?b+"["+c+"]":c,d.push("object"==typeof e?this.Serialize(e,c):encodeURIComponent(c)+"="+encodeURIComponent(e));return d.join("&")},a.prototype.Error=function(a){var b,c,d,e;if(c="","undefind"!=typeof a.errors){e=a.errors;for(b in e)d=e[b],c+=d+"<br />"}else c=a.error;return this.options.notice("Error",c)},a.prototype.Authenticate=function(a,b){var c;return this.options.publicId.length<=0&&"function"==typeof b&&b("error","Public ID must be set",401),this.options.secretKey.length<=0&&"function"==typeof b&&b("error","Secret Key must be set",401),null!==this.Storage.get("mtoken")&&parseInt(this.Storage.get("mexpires"))>Date.now()?(this.options.auth={token:this.Storage.get("mtoken"),expires:this.Storage.get("mexpires")},"function"==typeof a&&a(this.options.auth),this):(c={grant_type:"client_credentials",client_id:this.options.publicId,client_secret:this.options.secretKey},this.Ajax({method:"POST",path:"/oauth/access_token",data:c,async:"function"==typeof a,headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){return function(c,d,e){b.options.auth={token:c.access_token,expires:1e3*parseInt(c.expires)},b.Storage.set("mtoken",c.access_token),b.Storage.set("mexpires",b.options.auth.expires),"function"==typeof a&&a(c)}}(this),error:function(a){return function(a,c,d){return"function"==typeof b?b("error","Authorization failed",401):void 0}}(this)}),this)},a.prototype.Request=function(a,b,c,d,e){var f,g;return null==b&&(b="GET"),null==c&&(c=null),f={},g={"Content-Type":"application/x-www-form-urlencoded",Authorization:"Bearer "+this.options.auth.token},null===this.options.auth.token&&"function"==typeof e&&e("error","You much authenticate first",401),Date.now()>parseInt(this.Storage.get("mexpires"))&&this.Authenticate(null,e),this.InArray(b,this.options.methods)||"function"==typeof e&&e("error","Invalid request method ("+b+")",400),this.options.currency&&(g["X-Currency"]=this.options.currency),this.options.language&&(g["X-Language"]=this.options.language),this.Ajax({method:b,path:a,data:c,async:"function"==typeof d,headers:g,success:function(a){return function(a,b,c){return"function"==typeof d?d(a.result,"undefined"!=typeof a.pagination?a.pagination:null):f=a}}(this),error:function(a){return function(b,c,d){return b.status===!1&&("function"==typeof e?e("error","undefined"!=typeof b.errors?b.errors:b.error,c):a.Error("undefined"!=typeof b.errors?b.errors:b.error)),f=b}}(this)}),"undefined"==typeof d?f.result:void 0},a.prototype.Ajax=function(a){var b,c;return this.http||(this.http=require("https")),b={method:"GET",async:!1,data:null,timeout:6e4,headers:{},host:this.options.url,port:443,path:"/",withCredentials:!1,success:function(a,b,c){},error:function(a,b,c){}},b=this.Merge(b,a),b.method=b.method.toUpperCase(),b.path="/"!==b.path.substr(0,1)?"/"+this.options.version+"/"+b.path:b.path,"GET"===b.method&&null!==b.data&&(b.path+="?"+this.Serialize(b.data),b.data=null),c=this.http.request(b,function(a){var d;return d="",a.on("data",function(a){return d+=a}),a.on("end",function(){var e,f;f=JSON.parse(d);try{return"2"!==a.statusCode.toString().charAt(0)?b.error(f,a.statusCode,c):b.success(f,a.statusCode,c)}catch(g){return e=g,b.error(e.message,a.statusCode,c)}})}),this.InArray(b.method,["POST","PUT"])&&null!==b.data&&c.write(this.Serialize(b.data)),c.end()},z=function(){function a(){}return a.prototype.data={},a.prototype.set=function(a,b){return this.data[a]=b,b},a.prototype.get=function(a){return null!=this.data[a]?this.data[a]:null},a.prototype.remove=function(a){return null!=this.data[a]?delete this.data[a]:!1},a}(),b=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request(this.endpoint+"/"+a,"GET",null,b,c)},a.prototype.Find=function(a,b,c){return this.m.Request(this.endpoint,"GET",a,b,c)},a.prototype.List=function(a,b,c){return this.m.Request(this.endpoint,"GET",a,b,c)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d=this.endpoint+"/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a.prototype.Create=function(a,b,c){return this.m.Request(this.endpoint,"POST",a,b,c)},a.prototype.Update=function(a,b,c,d){return this.m.Request(this.endpoint+"/"+a,"PUT",b,c,d)},a.prototype.Delete=function(a,b,c){return this.m.Request(this.endpoint+"/"+a,"DELETE",null,b,c)},a}(),c=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses/"+b,"GET",null,c,d)},a.prototype.Find=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","GET",b,c,d)},a.prototype.List=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","GET",b,c,d)},a.prototype.Create=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","POST",b,c,d)},a.prototype.Fields=function(a,b,c,d){var e;return null==a&&(a=0),null==b&&(b=0),e=a>0&&0>=b?"customers/"+a+"/addresses/fields":a>0&&b>0?"customers/"+a+"/addresses/"+b+"/fields":"addresses/fields",this.m.Request(e,"GET",null,c,d)},a.prototype.Update=function(a,b,c,d,e){return this.m.Request("customers/"+a+"/addresses/"+b,"PUT",c,d,e)},a}(),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="brands",b}(b),e=function(){function a(a){this.m=a}return a.prototype.List=function(a,b,c){return this.m.Request("cache","GET",a,b,c)},a.prototype.Clear=function(a,b,c){return this.m.Request("cache/"+a,"DELETE",null,b,c)},a.prototype.Purge=function(a,b,c){return this.m.Request("cache/all","DELETE",null,b,c)},a}(),f=function(){function a(a){this.m=a,this.cartId=this.Identifier()}return a.prototype.Identifier=function(a,b){return null==a&&(a=!1),null==b&&(b=!1),a||b||null===this.m.Storage.get("mcart")?(b||(b="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(a){return(16*Math.random()|0).toString(16)})),this.m.Storage.set("mcart",b),this.cartId=b,b):this.m.Storage.get("mcart")},a.prototype.Contents=function(a,b){return this.m.Request("carts/"+this.cartId,"GET",null,a,b)},a.prototype.Insert=function(a,b,c,d,e){return null==b&&(b=1),null==c&&(c=null),this.m.Request("carts/"+this.cartId,"POST",{id:a,quantity:b,modifier:c},d,e)},a.prototype.Update=function(a,b,c,d){return this.m.Request("carts/"+this.cartId+"/item/"+a,"PUT",b,c,d)},a.prototype.Delete=function(a,b){return this.m.Request("carts/"+this.cartId,"DELETE",null,a,b)},a.prototype.Remove=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/item/"+a,"DELETE",null,b,c)},a.prototype.Item=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/item/"+a,"GET",null,b,c)},a.prototype.InCart=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/has/"+a,"GET",null,b,c)},a.prototype.Checkout=function(a,b){return this.m.Request("carts/"+this.cartId+"/checkout","GET",null,a,b)},a.prototype.Complete=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/checkout","POST",a,b,c)},a.prototype.Discount=function(a,b,c){return null===a||a===!1?this.m.Request("carts/"+this.cartId+"/discount","DELETE",null,b,c):this.m.Request("carts/"+this.cartId+"/discount","POST",{code:a},b,c)},a.prototype.List=function(a,b,c){return this.m.Request("carts","GET",a,b,c)},a}(),g=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="categories",b.prototype.Tree=function(a,b,c){return this.m.Request(this.endpoint+"/tree","GET",a,b,c)},b.prototype.Order=function(a,b,c){return this.m.Request(this.endpoint+"/order","PUT",a,b,c)},b}(b),h=function(){function a(a){this.m=a}return a.prototype.Payment=function(a,b,c,d,e){return this.m.Request("checkout/payment/"+a+"/"+b,"POST",c,d,e)},a}(),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="collections",b}(b),j=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="currencies",b.prototype.Set=function(a,b,c){return this.m.Storage.set("mcurrency",a),this.m.options.currency=a,"function"==typeof b?b(a):void 0},b}(b),k=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="customers",b}(b),l=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="customers/groups",b}(b),m=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("emails/"+a,"GET",null,b,c)},a.prototype.List=function(a,b,c){return this.m.Request("emails","GET",a,b,c)},a.prototype.Create=function(a,b,c){return this.m.Request("emails","POST",a,b,c)},a.prototype.Update=function(a,b,c,d){return this.m.Request("emails/"+a,"PUT",b,c,d)},a.prototype.Delete=function(a){return this.m.Request("emails/"+a,"DELETE",null,callback,error)},a}(),n=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries/"+b,"GET",null,c,d)},a.prototype.Find=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries","GET",b,c,d)},a.prototype.List=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries","GET",b,c,d)},a.prototype.Fields=function(a,b,c,d){var e;return null==b&&(b=0),e="flows/"+a+"/entries/"+(0!==b?b+"/fields":"fields"),this.m.Request(e,"GET",null,c,d)},a.prototype.Create=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries/","POST",b,c,d)},a.prototype.Update=function(a,b,c,d,e){return this.m.Request("flows/"+a+"/entries/"+b,"PUT",c,d,e)},a.prototype.Delete=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries/"+b,"DELETE",null,c,d)},a}(),o=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("flows/"+a,"GET",null,b,c)},a.prototype.Create=function(a,b,c,d){return this.m.Request("flows/"+a+"/fields","POST",b,c,d)},a.prototype.Update=function(a,b,c,d,e){return this.m.Request("flows/"+a+"/fields/"+b,"PUT",c,d,e)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d="flows/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a.prototype.Types=function(a,b){return this.m.Request("flows/types","GET",null,a,b)},a.prototype.Type=function(a,b,c,d){return this.m.Request("flows/"+a+"/types/"+b+"/options","GET",null,c,d)},a.prototype.Options=function(a,b,c,d){return this.m.Request("flows/"+a+"/fields/"+b+"/options","GET",null,c,d)},a.prototype.Delete=function(a,b,c,d){return this.m.Request("flows/"+a+"/fields/"+b,"DELETE",null,c,d)},a}(),p=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("flows/"+a,"GET",null,b,c)},a.prototype.List=function(a,b,c){return this.m.Request("flows","GET",a,b,c)},a.prototype.Create=function(a,b,c){return this.m.Request("flows","POST",a,b,c)},a.prototype.Update=function(a,b,c,d){return this.m.Request("flows/"+a,"PUT",b,c,d)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d="flows/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a.prototype.Entries=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries","GET",b,c,d)},a.prototype.Types=function(a,b){return this.m.Request("flows/types","GET",null,a,b)},a.prototype.Delete=function(a,b,c){return this.m.Request("flows/"+a,"DELETE",null,b,c)},a}(),q=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("gateways/"+a,"GET",null,b,c)},a.prototype.List=function(a,b,c){return this.m.Request("gateways","GET",a,b,c)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d="gateways/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a.prototype.Update=function(a,b,c,d){return this.m.Request("gateways/"+a,"PUT",b,c,d)},a.prototype.Enable=function(a,b,c){return this.m.Request("gateways/"+a+"/enable","GET",null,b,c)},a.prototype.Disable=function(a,b,c){return this.m.Request("gateways/"+a+"/disable","GET",null,b,c)},a}(),r=function(){function a(a){this.m=a}return a.prototype.Set=function(a,b,c){return this.m.Storage.set("mlanguage",a),this.m.options.language=a,"function"==typeof b?b(a):void 0},a}(),s=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d){return this.m.Request("products/"+a+"/modifiers/"+b,"GET",null,c,d)},a.prototype.Create=function(a,b,c,d){return this.m.Request("products/"+a+"/modifiers","POST",b,c,d)},a.prototype.Update=function(a,b,c,d,e){return this.m.Request("products/"+a+"/modifiers/"+b,"PUT",c,d,e)},a.prototype.Fields=function(a,b,c,d){var e;return null==b&&(b=0),e="products/"+a+"/modifiers/"+(0!==b?b+"/fields":"fields"),this.m.Request(e,"GET",null,c,d)},a.prototype.Update=function(a,b,c,d){return this.m.Request("products/"+a+"/modifiers/"+b,"DELETE",null,c,d)},a}(),t=function(a){function b(a){this.m=a}return __extends(b,a),b.prototype.Items=function(a,b,c){return this.m.Request("orders/"+a+"/items","GET",null,b,c)},b.prototype.AddItem=function(a,b,c,d){return this.m.Request("orders/"+a+"/items","POST",b,c,d)},b.prototype.UpdateItem=function(a,b,c,d){return this.m.Request("orders/"+a+"/items","PUT",b,c,d)},b.prototype.RemoveItem=function(a,b,c,d){return this.m.Request("orders/"+a+"/items/"+b,"DELETE",null,c,d)},b}(b),u=function(){function a(a){this.m=a}return a.prototype.Authorize=function(a,b){return this.Process("authorize",a,b)},a.prototype.CompleteAuthorize=function(a,b){return this.Process("complete_authorize",a,b)},a.prototype.Capture=function(a,b){return this.Process("capture",a,b)},a.prototype.Purchase=function(a,b){return this.Process("purchase",a,b)},a.prototype.CompletePurchase=function(a,b){return this.Process("complete_purchase",a,b)},a.prototype.Refund=function(a,b){return this.Process("refund",a,b)},a.prototype.Void=function(a,b){return this.Process("void",a,b)},a.prototype.Process=function(a,b,c,d,e){return this.m.Request("checkout/payment/"+a+"/"+b,"POST",c,d,e)},a}(),v=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="products",b.prototype.Search=function(a,b,c){return this.m.Request(this.endpoint+"/search","GET",a,b,c)},b.prototype.Modifiers=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/modifiers","GET",null,b,c)},b.prototype.Variations=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/variations","GET",null,b,c)},b}(b),w=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="promotions/cart",b.prototype.Search=function(a,b,c){return this.m.Request(this.endpoint+"/search","GET",a,b,c)},b}(b),x=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="shipping",b}(b),y=function(){function a(a){this.m=a}return a.prototype.available=["24hours","7days","30days"],a.prototype.Store=function(a,b,c,d){return null==a&&(a=null),null==b&&(b=null),this.Stats("store",a,b,c,d)},a.prototype.Revenue=function(a,b,c,d){return null==a&&(a=null),null==b&&(b=null),this.Stats("revenue",a,b,c,d)},a.prototype.Orders=function(a,b,c,d){return null==a&&(a=null),null==b&&(b=null),this.Stats("orders",a,b,c,d)},a.prototype.Customers=function(a,b,c,d){return null==a&&(a=null),null==b&&(b=null),this.Stats("customers",a,b,c,d)},a.prototype.Stats=function(a,b,c,d,e){var f;return null==b&&(b=null),null==c&&(c=null),f={},this.m.InArray(b,this.available)?f.timeframe=b:null!==b&&(f.from=b),null!==c&&(f.to=c),this.m.Request("statistics/"+a,"GET",f,d,e)},a}(),A=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="taxes",b}(b),B=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("transactions/"+a,"GET",null,b,c)},a.prototype.Listing=function(a,b,c){return this.m.Request("transactions","GET",a,b,c)},a}(),C=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d,e){return this.m.Request("products/"+a+"/modifiers/"+b+"/variations/"+c,"GET",null,d,e)},a.prototype.Create=function(a,b,c,d,e){return this.m.Request("products/"+a+"/modifiers/"+b+"/variations/","POST",c,d,e)},a.prototype.Update=function(a,b,c,d,e,f){return this.m.Request("products/"+a+"/modifiers/"+b+"/variations/"+c,"PUT",d,e,f)},a.prototype.Fields=function(a,b,c,d,e){var f;return null==c&&(c=0),f="products/"+a+"/modifiers/"+b+"/variations/"+(0!==c?c+"/fields":"fields"),this.m.Request(f,"GET",null,d,e)},a.prototype.Delete=function(a,b,c,d,e){return this.m.Request("products/"+a+"/modifiers/"+b+"/variations/"+c,"DELETE",null,d,e)},a}(),D=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("webhooks/"+a,"GET",null,b,c)},a.prototype.List=function(a,b,c){return this.m.Request("webhooks/"+id,"GET",a,b,c)},a.prototype.Create=function(a,b,c){return this.m.Request("webhooks","POST",a,b,c)},a.prototype.Update=function(a,b,c,d){return this.m.Request("webhooks/"+a,"PUT",b,c,d)},a.prototype.Delete=function(a,b,c){return this.m.Request("webhooks/"+a,"DELETE",null,b,c)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d="webhooks/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a}(),a}(),module.exports=function(a){return new Moltin(a)};
//# sourceMappingURL=moltin.nodejs.min.map