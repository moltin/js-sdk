/*! moltin (js) minified - v1.0.4 - 2016-09-12 */
var Moltin,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};Moltin=function(){"use strict";function a(a){return this.Helper=new c,this.config=this.Helper.Merge(this.config,a),this.Storage=new f(this),this.RequestFactory=new e(this),this.Products=new d(this),this.Storage.get("mcurrency")&&(this.config.currency=this.Storage.get("mcurrency")),this.Storage.get("mlanguage")&&(this.config.language=this.Storage.get("mlanguage")),this}var b,c,d,e,f;return a.prototype.config={clientId:"umRG34nxZVGIuCSPfYf8biBSvtABgTR8GMUtflyE",host:"api.molt.in",port:"443",protocol:"https",version:"v1",debug:!1,currency:!1,language:!1,timeout:6e4,contentType:"application/json",auth:{expires:3600,uri:"oauth/access_token"},methods:["GET","POST","PUT","DELETE"]},a.prototype.Authenticate=function(){var a,b,c,d,e,f;if(this.config.clientId.length<=0)throw new Error("You must have a client id set");return b={grant_type:"implicit",client_id:this.config.clientId},c={"Content-Type":"application/x-www-form-urlencoded"},e=this.RequestFactory,f=this.Storage,a=this.config,d=new Promise(function(d,g){return e.make(a.auth.uri,"POST",b,c).then(function(a){return f.set("mexpires",a.expires),f.set("mtoken",a.access_token),d(a)}).catch(function(a){return g(a)})})},a.prototype.Request=function(a,b,c,d){var e,f,g;return null==d&&(d={}),f=this.RequestFactory,g=this.Storage,e=new Promise(function(e,h){var i;return i=g.get("mtoken"),d.Authorization="Bearer: "+i,f.make(a,b,c,d).then(function(a){return e(a)}).catch(function(a){return h(a)})}),g.get(Date.now()>=g.get("mexpires"))?this.Authenticate.then()(function(){return e}):e},b=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request(this.endpoint+"/"+a,"GET",null,b,c)},a.prototype.Find=function(a,b,c){return this.m.Request(this.endpoint,"GET",a,b,c)},a.prototype.List=function(a){return this.m.Request(this.endpoint,"GET",a)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d=this.endpoint+"/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a}(),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="products",b.prototype.Search=function(a,b,c){return this.m.Request(this.endpoint+"/search","GET",a,b,c)},b.prototype.Modifiers=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/modifiers","GET",null,b,c)},b.prototype.Variations=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/variations","GET",null,b,c)},b}(b),c=function(){function a(){}return a.prototype.Merge=function(a,b){var c,d,e;d={};for(c in a)e=a[c],d[c]=e;for(c in b)e=b[c],d[c]=e;return d},a.prototype.InArray=function(a,b){return!(!b||__indexOf.call(b,a)<0)},a.prototype.Serialize=function(a,b){var c,d,e;null==b&&(b=null),d=[];for(c in a)e=a[c],c=null!==b?b+"["+c+"]":c,d.push("object"==typeof e?this.Serialize(e,c):encodeURIComponent(c)+"="+encodeURIComponent(e));return d.join("&")},a.prototype.Error=function(a){var b,c,d,e;if(c="","undefind"!=typeof a.errors){e=a.errors;for(b in e)d=e[b],c+=d+"<br />"}else c=a.error;return this.options.notice("Error",c)},a}(),e=function(){function a(a){var b;this.m=a;try{this.driver=new XMLHttpRequest}catch(a){b=a;try{this.driver=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){throw b=a,new Error("Request factory boot failed")}}return this}var b;return b=!1,a.prototype.make=function(a,b,c,d){var e,f,g,h,i,j;b=b.toUpperCase(),i=this.m.config.protocol+"://"+this.m.config.host+("oauth/access_token"!==a?"/"+this.m.config.version+"/"+a:"/"+a),"GET"===b?(i+="?"+this.m.Helper.Serialize(c),c=null):c=this.m.Helper.Serialize(c),this.driver.open(b,i,!0),h=setTimeout(function(a){return function(){return a.driver.abort(),a.driver.error(a.driver,408,"Your request timed out")}}(this),this.m.config.timeout);for(e in d)j=d[e],this.driver.setRequestHeader(e,j);return g=this.driver,f=new Promise(function(a,b){return g.onreadystatechange=function(){var c,d;if(4!==g.readyState)return null;clearTimeout(h);try{return d=JSON.parse(g.responseText),a(d)}catch(a){return c=a,b(new Error(c))}}}),this.driver.send(c),f},a}(),f=function(){function a(a){this.m=a}return a.prototype.set=function(a,b){return window.localStorage.setItem(a,b)},a.prototype.get=function(a){return window.localStorage.getItem(a)},a.prototype.delete=function(a){return window.localStorage.removeItem(a)},a}(),a}();
//# sourceMappingURL=moltin.min.map