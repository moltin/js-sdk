/*! moltin (js) minified - v1.0.4 - 2016-08-29 */
var Moltin,__indexOf=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1},__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};Moltin=function(){"use strict";function a(a){this.options=this.Merge(this.options,a),this.Storage=new p,this.Address=new c(this),this.Brand=new d(this),this.Cart=new e(this),this.Category=new f(this),this.Checkout=new g(this),this.Collection=new h(this),this.Currency=new i(this),this.Entry=new j(this),this.Gateway=new k(this),this.Language=new l(this),this.Order=new m(this),this.Product=new n(this),this.Shipping=new o(this),this.Tax=new q(this),this.Storage.get("mcurrency")&&(this.options.currency=this.Storage.get("mcurrency")),this.Storage.get("mlanguage")&&(this.options.language=this.Storage.get("mlanguage"))}var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return a.prototype.options={publicId:"",secretKey:"",auth:{},url:"api.molt.in",version:"v1",debug:!1,currency:!1,language:!1,methods:["GET","POST","PUT","DELETE"],notice:function(a,b){return console.log(a+": "+b)}},a.prototype.Merge=function(a,b){var c,d,e;d={};for(c in a)e=a[c],d[c]=e;for(c in b)e=b[c],d[c]=e;return d},a.prototype.InArray=function(a,b){return!(!b||__indexOf.call(b,a)<0)},a.prototype.Serialize=function(a,b){var c,d,e;null==b&&(b=null),d=[];for(c in a)e=a[c],c=null!==b?b+"["+c+"]":c,d.push("object"==typeof e?this.Serialize(e,c):encodeURIComponent(c)+"="+encodeURIComponent(e));return d.join("&")},a.prototype.Error=function(a){var b,c,d,e;if(c="","undefind"!=typeof a.errors){e=a.errors;for(b in e)d=e[b],c+=d+"<br />"}else c=a.error;return this.options.notice("Error",c)},a.prototype.Authenticate=function(a,b){var c,d;return this.options.publicId.length<=0&&"function"==typeof b&&b("error","Public ID must be set",401),null!==this.Storage.get("mtoken")&&parseInt(this.Storage.get("mexpires"))>Date.now()?(this.options.auth={expires:1e3*parseInt(this.Storage.get("mexpires")),token:this.Storage.get("mtoken")},"function"==typeof a&&a(this.options.auth),d=document.createEvent("CustomEvent"),d.initCustomEvent("MoltinReady",!1,!1,this),window.dispatchEvent(d),this):(c={grant_type:"implicit",client_id:this.options.publicId},this.Ajax({method:"POST",path:"/oauth/access_token",data:c,async:"function"==typeof a,headers:{"Content-Type":"application/x-www-form-urlencoded"},success:function(b){return function(c,e,f){b.Storage.set("mexpires",c.expires),b.Storage.set("mtoken",c.token_type+" "+c.access_token),b.options.auth={expires:1e3*parseInt(b.Storage.get("mexpires")),token:b.Storage.get("mtoken")},"function"==typeof a&&a(c),d=document.createEvent("CustomEvent"),d.initCustomEvent("MoltinReady",!1,!1,b),window.dispatchEvent(d)}}(this),error:function(a){return function(a,c,d){if("function"==typeof b)return b("error","Authorization failed",401)}}(this)}),this)},a.prototype.Request=function(a,b,c,d,e){var f,g;if(null==b&&(b="GET"),null==c&&(c=null),f={},g={"Content-Type":"application/x-www-form-urlencoded",Authorization:this.options.auth.token},null===this.options.auth.token&&"function"==typeof e&&e("error","You much authenticate first",401),Date.now()>=this.options.auth.expires&&this.Authenticate(null,e),this.InArray(b,this.options.methods)||"function"==typeof e&&e("error","Invalid request method ("+b+")",400),this.options.currency&&(g["X-Currency"]=this.options.currency),this.options.language&&(g["X-Language"]=this.options.language),this.Ajax({method:b,path:a,data:c,async:"function"==typeof d,headers:g,success:function(a){return function(a,b,c){return"function"==typeof d?d(a.result,"undefined"!=typeof a.pagination?a.pagination:null):f=a}}(this),error:function(a){return function(b,c,d){return b.status===!1&&("function"==typeof e?e("error","undefined"!=typeof b.errors?b.errors:b.error,c):a.Error("undefined"!=typeof b.errors?b.errors:b.error)),f=b}}(this)}),"undefined"==typeof d)return f.result},a.prototype.Ajax=function(a){var b,c,d,e,f,g,h;b={method:"GET",async:!1,data:null,timeout:6e4,headers:{},host:this.options.url,port:443,path:"/",success:function(a,b,c){},error:function(a,b,c){}},b=this.Merge(b,a),b.method=b.method.toUpperCase();try{e=new XMLHttpRequest}catch(a){c=a;try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(a){return c=a,!1}}b.url=(443===b.port?"https://":"http://")+b.host+("/"!==b.path.substr(0,1)?"/"+this.options.version+"/"+b.path:b.path),"GET"===b.method?(b.url+="?"+this.Serialize(b.data),b.data=null):b.data=this.Serialize(b.data),e.open(b.method,b.url,b.async),f=setTimeout(function(a){return function(){return e.abort(),b.error(e,408,"Your request timed out")}}(this),b.timeout),h=b.headers;for(d in h)g=h[d],e.setRequestHeader(d,g);return e.onreadystatechange=function(){var a;return 4!==e.readyState?null:(clearTimeout(f),a=JSON.parse(e.responseText),"2"!==e.status.toString().charAt(0)?b.error(a,e.status,e):b.success(a,e.status,e))},e.send(b.data)},p=function(){function a(){}return a.prototype.set=function(a,b,c){var d,e;return e="",c&&(d=new Date,d.setTime(d.getTime()+24*c*60*60*1e3),e="; expires="+d.toGMTString()),document.cookie=a+"="+b+e+"; path=/"},a.prototype.get=function(a){var b,c,d,e;for(a+="=",e=document.cookie.split(";"),c=0,d=e.length;c<d;c++){for(b=e[c];" "===b.charAt(0);)b=b.substring(1,b.length);if(0===b.indexOf(a))return b.substring(a.length,b.length)}return null},a.prototype.remove=function(a){return this.set(a,"",-1)},a}(),b=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request(this.endpoint+"/"+a,"GET",null,b,c)},a.prototype.Find=function(a,b,c){return this.m.Request(this.endpoint,"GET",a,b,c)},a.prototype.List=function(a,b,c){return this.m.Request(this.endpoint,"GET",a,b,c)},a.prototype.Fields=function(a,b,c){var d;return null==a&&(a=0),d=this.endpoint+"/"+(0!==a?a+"/fields":"fields"),this.m.Request(d,"GET",null,b,c)},a}(),c=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses/"+b,"GET",null,c,d)},a.prototype.Find=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","GET",b,c,d)},a.prototype.List=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","GET",b,c,d)},a.prototype.Create=function(a,b,c,d){return this.m.Request("customers/"+a+"/addresses","POST",b,c,d)},a.prototype.Fields=function(a,b,c,d){var e;return null==a&&(a=0),null==b&&(b=0),e=a>0&&b<=0?"customers/"+a+"/addresses/fields":a>0&&b>0?"customers/"+a+"/addresses/"+b+"/fields":"addresses/fields",this.m.Request(e,"GET",null,c,d)},a}(),d=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="brands",b}(b),e=function(){function a(a){this.m=a,this.cartId=this.Identifier()}return a.prototype.Identifier=function(a,b){return null==a&&(a=!1),null==b&&(b=!1),a||b||null===this.m.Storage.get("mcart")?(b||(b="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(a){return(16*Math.random()|0).toString(16)})),this.m.Storage.set("mcart",b),this.cartId=b,b):this.m.Storage.get("mcart")},a.prototype.Contents=function(a,b){return this.m.Request("carts/"+this.cartId,"GET",null,a,b)},a.prototype.Insert=function(a,b,c,d,e){return null==b&&(b=1),null==c&&(c=null),this.m.Request("carts/"+this.cartId,"POST",{id:a,quantity:b,modifier:c},d,e)},a.prototype.Update=function(a,b,c,d){return this.m.Request("carts/"+this.cartId+"/item/"+a,"PUT",b,c,d)},a.prototype.Delete=function(a,b){return this.m.Request("carts/"+this.cartId,"DELETE",null,a,b)},a.prototype.Remove=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/item/"+a,"DELETE",null,b,c)},a.prototype.Item=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/item/"+a,"GET",null,b,c)},a.prototype.InCart=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/has/"+a,"GET",null,b,c)},a.prototype.Checkout=function(a,b){return this.m.Request("carts/"+this.cartId+"/checkout","GET",null,a,b)},a.prototype.Complete=function(a,b,c){return this.m.Request("carts/"+this.cartId+"/checkout","POST",a,b,c)},a.prototype.Discount=function(a,b,c){return null===a||a===!1?this.m.Request("carts/"+this.cartId+"/discount","DELETE",null,b,c):this.m.Request("carts/"+this.cartId+"/discount","POST",{code:a},b,c)},a}(),f=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="categories",b.prototype.Tree=function(a,b,c){return this.m.Request(this.endpoint+"/tree","GET",a,b,c)},b}(b),g=function(){function a(a){this.m=a}return a.prototype.Payment=function(a,b,c,d,e){return this.m.Request("checkout/payment/"+a+"/"+b,"POST",c,d,e)},a}(),h=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="collections",b}(b),i=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="currencies",b.prototype.Set=function(a,b,c){if(this.m.Storage.set("mcurrency",a),this.m.options.currency=a,"function"==typeof b)return b(a)},b}(b),j=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries/"+b,"GET",null,c,d)},a.prototype.Find=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries/search","GET",b,c,d)},a.prototype.List=function(a,b,c,d){return this.m.Request("flows/"+a+"/entries","GET",b,c,d)},a}(),k=function(){function a(a){this.m=a}return a.prototype.Get=function(a,b,c){return this.m.Request("gateways/"+a,"GET",null,b,c)},a.prototype.List=function(a,b,c){return this.m.Request("gateways","GET",a,b,c)},a}(),l=function(){function a(a){this.m=a}return a.prototype.Set=function(a,b,c){if(this.m.Storage.set("mlanguage",a),this.m.options.language=a,"function"==typeof b)return b(a)},a}(),m=function(a){function b(a){this.m=a}return __extends(b,a),b.prototype.endpoint="orders",b}(b),n=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="products",b.prototype.Search=function(a,b,c){return this.m.Request(this.endpoint+"/search","GET",a,b,c)},b.prototype.Modifiers=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/modifiers","GET",null,b,c)},b.prototype.Variations=function(a,b,c){return this.m.Request(this.endpoint+"/"+a+"/variations","GET",null,b,c)},b}(b),o=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="shipping",b}(b),q=function(a){function b(){return b.__super__.constructor.apply(this,arguments)}return __extends(b,a),b.prototype.endpoint="taxes",b}(b),a}();
//# sourceMappingURL=moltin.min.map